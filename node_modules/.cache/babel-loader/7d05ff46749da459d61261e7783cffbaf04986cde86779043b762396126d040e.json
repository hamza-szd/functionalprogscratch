{"ast":null,"code":"import Button from\"react-bootstrap/Button\";import Modal from\"react-bootstrap/Modal\";import ListGroup from\"react-bootstrap/ListGroup\";import ListGroupItem from\"react-bootstrap/ListGroupItem\";import{FileEarmarkArrowDownFill,PlusSquareFill}from\"react-bootstrap-icons\";import{useEffect,useState}from\"react\";import{projectsDB}from\"./project\";import{serializeExprWithAttributes}from\"../trees/serialize\";import{serializeProjectMeta}from\"../../project-meta\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function SaveDialog(_ref){let{show,onHide,editor}=_ref;const[projects,setProjects]=useState();async function fetchProjects(){const db=await projectsDB();const projects=await db.getAll(\"projects\");setProjects(projects.sort((a,b)=>{var _b$modified,_a$modified;return((_b$modified=b.modified)!==null&&_b$modified!==void 0?_b$modified:0)-((_a$modified=a.modified)!==null&&_a$modified!==void 0?_a$modified:0);}));}useEffect(()=>{if(show)fetchProjects();},[show]);function serializeProject(name){const source=serializeProjectMeta(editor.trees.meta)+editor.trees.list().map(tree=>{var _tree$root$attributes;tree.root.attributes=(_tree$root$attributes=tree.root.attributes)!==null&&_tree$root$attributes!==void 0?_tree$root$attributes:{};tree.root.attributes.location=tree.location;tree.root.attributes.page=tree.page;return serializeExprWithAttributes(tree.root);}).join(\"\\n\");return{modified:new Date().getTime(),name,source};}return/*#__PURE__*/_jsxs(Modal,{size:\"lg\",show:show,onHide:()=>onHide(),centered:true,backdropClassName:\"modal-backdrop\",children:[/*#__PURE__*/_jsx(Modal.Header,{closeButton:true,children:/*#__PURE__*/_jsx(Modal.Title,{children:\"Save Project\"})}),/*#__PURE__*/_jsx(Modal.Body,{style:{height:\"50vh\",overflow:\"auto\"},children:/*#__PURE__*/_jsx(ListGroup,{className:\"mb-2\",children:projects===null||projects===void 0?void 0:projects.map(project=>/*#__PURE__*/_jsxs(ListGroupItem,{className:\"d-flex align-items-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"me-auto\",children:project.name}),/*#__PURE__*/_jsxs(Button,{size:\"sm\",variant:\"outline-success\",className:\"d-flex align-items-center me-2\",onClick:async event=>{event.stopPropagation();const newProject=serializeProject(project.name);newProject.id=project.id;const db=await projectsDB();db.put(\"projects\",newProject);onHide();},children:[/*#__PURE__*/_jsx(FileEarmarkArrowDownFill,{className:\"me-2\"}),\"Overwrite\"]})]},project.id))})}),/*#__PURE__*/_jsx(Modal.Footer,{children:/*#__PURE__*/_jsxs(Button,{variant:\"success\",className:\"d-flex align-items-center\",onClick:async event=>{event.stopPropagation();const name=prompt(\"Name your project:\");if(name===null)return;const project=serializeProject(name);const db=await projectsDB();db.add(\"projects\",project);onHide();},children:[/*#__PURE__*/_jsx(PlusSquareFill,{className:\"me-2\"}),\"Save New\"]})})]});}","map":{"version":3,"names":["Button","Modal","ListGroup","ListGroupItem","FileEarmarkArrowDownFill","PlusSquareFill","useEffect","useState","projectsDB","serializeExprWithAttributes","serializeProjectMeta","jsx","_jsx","jsxs","_jsxs","SaveDialog","_ref","show","onHide","editor","projects","setProjects","fetchProjects","db","getAll","sort","a","b","_b$modified","_a$modified","modified","serializeProject","name","source","trees","meta","list","map","tree","_tree$root$attributes","root","attributes","location","page","join","Date","getTime","size","centered","backdropClassName","children","Header","closeButton","Title","Body","style","height","overflow","className","project","variant","onClick","event","stopPropagation","newProject","id","put","Footer","prompt","add"],"sources":["/Users/hamzashahzad/Desktop/resume_projects/sparkground/src/editor/projects/SaveDialog.tsx"],"sourcesContent":["import Button from \"react-bootstrap/Button\";\nimport Modal from \"react-bootstrap/Modal\";\nimport ListGroup from \"react-bootstrap/ListGroup\";\nimport ListGroupItem from \"react-bootstrap/ListGroupItem\";\nimport { FileEarmarkArrowDownFill, PlusSquareFill } from \"react-bootstrap-icons\";\nimport { useEffect, useState } from \"react\";\nimport { Project, projectsDB } from \"./project\";\nimport { serializeExprWithAttributes } from \"../trees/serialize\";\nimport { serializeProjectMeta } from \"../../project-meta\";\nimport { Editor } from \"../state/Editor\";\n\nexport type Props = {\n  show: boolean;\n  onHide: () => void;\n\n  editor: Editor;\n};\n\nexport default function SaveDialog({ show, onHide, editor }: Props) {\n  const [projects, setProjects] = useState<Project[]>();\n\n  async function fetchProjects() {\n    const db = await projectsDB();\n    const projects = await db.getAll(\"projects\");\n    setProjects(projects.sort((a, b) => (b.modified ?? 0) - (a.modified ?? 0)));\n  }\n\n  useEffect(() => {\n    if (show) fetchProjects();\n  }, [show]);\n\n  function serializeProject(name: string): Project {\n    const source =\n      serializeProjectMeta(editor.trees.meta) +\n      editor.trees\n        .list()\n        .map((tree) => {\n          tree.root.attributes = tree.root.attributes ?? {};\n          tree.root.attributes.location = tree.location;\n          tree.root.attributes.page = tree.page;\n          return serializeExprWithAttributes(tree.root);\n        })\n        .join(\"\\n\");\n\n    return {\n      modified: new Date().getTime(),\n      name,\n      source,\n    };\n  }\n\n  return (\n    <Modal\n      size=\"lg\"\n      show={show}\n      onHide={() => onHide()}\n      centered\n      backdropClassName=\"modal-backdrop\"\n    >\n      <Modal.Header closeButton>\n        <Modal.Title>Save Project</Modal.Title>\n      </Modal.Header>\n      <Modal.Body\n        style={{\n          height: \"50vh\",\n          overflow: \"auto\",\n        }}\n      >\n        <ListGroup className=\"mb-2\">\n          {projects?.map((project) => (\n            <ListGroupItem key={project.id} className=\"d-flex align-items-center\">\n              <div className=\"me-auto\">{project.name}</div>\n\n              <Button\n                size=\"sm\"\n                variant=\"outline-success\"\n                className=\"d-flex align-items-center me-2\"\n                onClick={async (event) => {\n                  event.stopPropagation();\n\n                  const newProject = serializeProject(project.name);\n                  newProject.id = project.id;\n\n                  const db = await projectsDB();\n                  db.put(\"projects\", newProject);\n\n                  onHide();\n                }}\n              >\n                <FileEarmarkArrowDownFill className=\"me-2\" />\n                Overwrite\n              </Button>\n            </ListGroupItem>\n          ))}\n        </ListGroup>\n      </Modal.Body>\n      <Modal.Footer>\n        <Button\n          variant=\"success\"\n          className=\"d-flex align-items-center\"\n          onClick={async (event) => {\n            event.stopPropagation();\n\n            const name = prompt(\"Name your project:\");\n            if (name === null) return;\n\n            const project = serializeProject(name);\n\n            const db = await projectsDB();\n            db.add(\"projects\", project);\n\n            onHide();\n          }}\n        >\n          <PlusSquareFill className=\"me-2\" />\n          Save New\n        </Button>\n      </Modal.Footer>\n    </Modal>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}
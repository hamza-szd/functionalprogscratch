{"ast":null,"code":"import{useContext,useEffect,useRef,useState}from\"react\";import{useDraggable,useDroppable}from\"@dnd-kit/core\";import{ContextMenuTrigger}from\"rctx-contextmenu\";import{callEach}from\"../../util\";import{nodeAtIndexPath,extendIndexPath}from\"../trees/tree\";import BlockPullTab from\"./BlockPullTab\";import Tippy from\"@tippyjs/react\";import{followCursor}from\"tippy.js\";import{functionMaxArgCount,hasTag}from\"../../typechecker/type\";import{prettyPrintType}from\"../../typechecker/serialize\";import{describeTypecheckError}from\"../../typechecker/errors\";import{ActiveDragContext,OnContextMenuContext,RenderCounterContext,RerenderContext}from\"../editor-contexts\";import{describeRuntimeError}from\"../../evaluator/errors\";import{prettyPrintSignatureNames}from\"../../evaluator/dynamic-type\";import{jsxs as _jsxs,Fragment as _Fragment,jsx as _jsx}from\"react/jsx-runtime\";export default function Block(_ref){var _indexPath$path,_binding$cell$value,_binding$attributes;let{id,indexPath,data,isCopySource,typechecker,editor,identifierTag,forDragOverlay,onEditValue,children}=_ref;const activeDrag=useContext(ActiveDragContext);const onContextMenu=useContext(OnContextMenuContext);const rerender=useContext(RerenderContext);useContext(RenderCounterContext);const isAnyType=data.type===\"type\"&&data.id===\"?\";const nameable=(data.type===\"name-hole\"||data.type===\"type-name-hole\")&&!indexPath.tree.id.startsWith(\"library\");const preventDrag=nameable||isAnyType;// Drop area, if applicable\nconst droppable=!(isCopySource||((_indexPath$path=indexPath.path)===null||_indexPath$path===void 0?void 0:_indexPath$path.length)===0);// Need to call useDroppable hook on *every* render\nconst usedDroppable=useDroppable({id,data:{indexPath}});let{isOver,setNodeRef:setNodeRef1}=droppable?usedDroppable:{isOver:false,setNodeRef:()=>{}};let binding;switch(data.type){case\"hat\":case\"v\":case\"h\":case\"ident\":case\"name-binding\":binding=data.binding;}// Draggable, if applicable\nconst draggable=!(forDragOverlay||data.type===\"hole\"||data.type===\"name-hole\"||data.type===\"type-name-hole\"||isAnyType);// Also need to call useDraggable hook on *every* render\nconst usedDraggable=useDraggable({id,data:{indexPath,copyOnDrop:isCopySource,contextHelpSubject:binding}});let{active,over,attributes,listeners,setNodeRef:setNodeRef2}=draggable?usedDraggable:{active:null,over:typeof forDragOverlay===\"object\"?forDragOverlay:null,attributes:[],listeners:[],setNodeRef:()=>{}};const expr=(()=>{try{return nodeAtIndexPath(indexPath);}catch{return undefined;}})();const divRef=useRef(null);const[tooltipVisible,setTooltipVisible]=useState(false);const[type,setType]=useState(\"\");const[calledType,setCalledType]=useState();useEffect(()=>{try{setType(typechecker.inferSubexprType(indexPath));setCalledType((expr===null||expr===void 0?void 0:expr.kind)===\"call\"?typechecker.inferSubexprType(extendIndexPath(indexPath,0)):undefined);}catch(error){var _describeTypecheckErr;setType((_describeTypecheckErr=describeTypecheckError(error))!==null&&_describeTypecheckErr!==void 0?_describeTypecheckErr:`${error}`);}if(identifierTag){if(tooltipVisible){document.body.classList.add(`highlight-identifier-${identifierTag}`);}else{document.body.classList.remove(`highlight-identifier-${identifierTag}`);}}rerender===null||rerender===void 0?void 0:rerender();},[tooltipVisible,activeDrag]);let contextHelp;// TODO: Stop relying on Value bindings here; use a richer `doc` attribute instead\nif(binding&&(((_binding$cell$value=binding.cell.value)===null||_binding$cell$value===void 0?void 0:_binding$cell$value.kind)===\"fn\"||(_binding$attributes=binding.attributes)!==null&&_binding$attributes!==void 0&&_binding$attributes.doc)){var _binding$cell$value2;const contextHelpName=/*#__PURE__*/_jsx(\"div\",{className:\"fst-mono d-flex align-items-end\",children:// TODO: Stop relying on Value bindings here; use a richer `doc` attribute instead\n((_binding$cell$value2=binding.cell.value)===null||_binding$cell$value2===void 0?void 0:_binding$cell$value2.kind)===\"fn\"?/*#__PURE__*/_jsxs(_Fragment,{children:[\"(\",binding.name,/*#__PURE__*/_jsxs(\"div\",{className:\"ms-2 fst-italic\",children:[prettyPrintSignatureNames(binding.cell.value.signature),\" \"]}),\")\"]}):binding.name});const contextHelpDoc=/*#__PURE__*/_jsx(\"div\",{className:\"mt-1\",children:(_binding$attributes2=>{let doc=(_binding$attributes2=binding.attributes)===null||_binding$attributes2===void 0?void 0:_binding$attributes2.doc;if(!doc)return\"\";let match;let rendered=/*#__PURE__*/_jsx(_Fragment,{});while(match=/^(?:[^`]+|`([^`]+)`)/.exec(doc)){doc=doc.slice(match[0].length);if(match[1]){rendered=/*#__PURE__*/_jsxs(_Fragment,{children:[rendered,/*#__PURE__*/_jsx(\"span\",{className:\"fst-mono fst-italic\",children:match[1]})]});}else{rendered=/*#__PURE__*/_jsxs(_Fragment,{children:[rendered,match[0]]});}}return rendered;})()});contextHelp=/*#__PURE__*/_jsxs(_Fragment,{children:[contextHelpName,\" \",contextHelpDoc]});}let typecheckingError=typechecker.errors.for(indexPath);if(!typecheckingError&&(expr===null||expr===void 0?void 0:expr.kind)===\"call\"){typecheckingError=typechecker.errors.for(extendIndexPath(indexPath,0));}const runtimeError=editor.runner.program.evaluator.errors.for(indexPath);const doubleClickAppliesAsFunction=data.type===\"ident\"&&typeof type===\"object\"&&(hasTag(type,\"Function\")||hasTag(type,\"Function*\"));const tooltipContentParts=[data.type===\"name-binding\"&&/*#__PURE__*/_jsx(\"small\",{children:\"Double-click to rename this variable\"}),nameable&&/*#__PURE__*/_jsxs(\"small\",{children:[\"Click to name this \",data.type===\"type-name-hole\"?\"type \":\"\",\"variable\"]}),isAnyType&&/*#__PURE__*/_jsx(\"small\",{children:\"Unknown type; you can drop a more specific type here\"}),onEditValue&&data.type===\"bool\"&&/*#__PURE__*/_jsx(\"small\",{children:\"Double-click to toggle value\"}),onEditValue&&(data.type===\"number\"||data.type===\"string\")&&/*#__PURE__*/_jsx(\"small\",{children:\"Double-click to edit value\"}),onEditValue&&doubleClickAppliesAsFunction&&/*#__PURE__*/_jsx(\"small\",{children:\"Double-click to apply function\"}),// Uncomment to see each block's index path in its tooltip:\n// <>\n//   <b>Index Path:</b> {indexPath.path.map((x) => `${x}`).join(\" \")}\n// </>,\n// Uncomment to see unbound references in each block's subtree, when considered\n// in isolation from its true context:\n// <>\n//   <b>Subtree Unbound References:</b>{\" \"}\n//   {unboundReferences(indexPath)\n//     .map((varRef) => varRef.id)\n//     .join(\", \")}\n// </>,\n!!runtimeError&&/*#__PURE__*/_jsxs(\"span\",{className:\"text-warning\",children:[/*#__PURE__*/_jsx(\"b\",{children:\"Runtime Error:\"}),\" \",/*#__PURE__*/_jsx(\"i\",{children:describeRuntimeError(runtimeError)})]}),!!typecheckingError&&/*#__PURE__*/_jsxs(\"span\",{className:\"text-warning\",children:[/*#__PURE__*/_jsx(\"b\",{children:\"Type Error:\"}),\" \",/*#__PURE__*/_jsx(\"i\",{children:describeTypecheckError(typecheckingError)}),\" \"]}),data.type!==\"type\"&&data.type!==\"type-var\"&&data.type!==\"type-name-binding\"&&data.type!==\"type-name-hole\"&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"b\",{children:\"Type:\"}),/*#__PURE__*/_jsx(\"div\",{className:\"mt-1 ms-2\",children:typeof type===\"string\"?/*#__PURE__*/_jsxs(\"span\",{className:\"text-warning\",children:[\"Error: \",/*#__PURE__*/_jsx(\"i\",{children:type}),\" \"]}):/*#__PURE__*/_jsx(\"span\",{className:\"fst-mono\",children:prettyPrintType(type)})})]}),calledType&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"b\",{children:\"Function Type:\"}),/*#__PURE__*/_jsx(\"div\",{className:\"mt-1 ms-2\",children:/*#__PURE__*/_jsx(\"span\",{className:\"fst-mono\",children:prettyPrintType(calledType)})})]}),contextHelp&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"b\",{children:\"Help:\"}),/*#__PURE__*/_jsx(\"div\",{className:\"mt-1 ms-2\",children:contextHelp})]})].filter(x=>x);const tooltipContent=tooltipContentParts.length?/*#__PURE__*/_jsx(\"div\",{className:\"d-flex flex-column mb-1\",style:{gap:\"0.5em\"},children:tooltipContentParts.map((part,index)=>/*#__PURE__*/_jsx(\"div\",{children:part},index))}):\"\";const contextMenuID=((_data$binding,_data$binding$attribu)=>{// TODO: Fix this unbound reference detection\n//       (it doesn't have access to the correct environment at the moment)\n// const evaluable = expr && unboundReferences(indexPath).length === 0 ? \"-evaluable\" : \"\";\nconst evaluable=\"-evaluable\";switch(data.type){case\"ident\":return\"block-menu-var\"+evaluable;case\"name-binding\":return(_data$binding=data.binding)!==null&&_data$binding!==void 0&&(_data$binding$attribu=_data$binding.attributes)!==null&&_data$binding$attribu!==void 0&&_data$binding$attribu.typeAnnotation?\"block-menu-namebinding-annotated\":\"block-menu-namebinding\";case\"name-hole\":return\"block-menu-namehole\";case\"type-name-binding\":return\"block-menu-typenamebinding\";case\"type-name-hole\":return\"block-menu-typenamehole\";case\"h\":case\"v\":return(data.calledIsVar?\"block-menu-call\":data.id===\"function\"?data.returnTypeAnnotation?\"block-menu-function-annotated\":\"block-menu-function\":\"block-menu\")+evaluable;case\"happly\":return(data?\"block-menu-apply\":\"block-menu\")+evaluable;}return\"block-menu\"+evaluable;})();const isTypeBlock=data=>data.type===\"type\"||data.type===\"type-var\";const validDraggedOver=isOver&&(!isTypeBlock(data)||(activeDrag===null||activeDrag===void 0?void 0:activeDrag.node.kind)===\"type\");const isVariadicCall=data.type===\"h\"&&expr&&expr.kind===\"call\"&&(typeof type!==\"string\"&&calledType?expr.args.length<functionMaxArgCount(calledType):true);const isAndOr=(expr===null||expr===void 0?void 0:expr.kind)===\"and\"||(expr===null||expr===void 0?void 0:expr.kind)===\"or\";return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"style\",{children:identifierTag?`\n          body.highlight-identifier-${identifierTag} .block-identifier-${identifierTag} > .block-hat-heading > .block-hat-label,\n          body.highlight-identifier-${identifierTag} .block-identifier-${identifierTag} > .block-v-heading > .block-v-label,\n          body.highlight-identifier-${identifierTag} .block-identifier-${identifierTag} > .block-h-label,\n          body.highlight-identifier-${identifierTag} .block-identifier-${identifierTag}.block-ident,\n          body.highlight-identifier-${identifierTag} .block-identifier-${identifierTag}.block-name-binding {\n            transition: all 50ms linear;\n            \n            font-weight: bold;\n            \n            box-shadow: 0px 0px 0.25em 0.4em rgba(255, 255, 50);\n            background-color: rgba(255, 255, 50)\n          }\n        `:\"\"}),/*#__PURE__*/_jsx(ContextMenuTrigger,{id:contextMenuID,children:/*#__PURE__*/_jsx(Tippy,{content:tooltipContent,className:\"text-bg-primary\",visible:!!tooltipContent&&tooltipVisible&&!forDragOverlay,arrow:false,plugins:[followCursor],followCursor:true,offset:[5,10],placement:\"top-start\",zIndex:99999999+2,children:/*#__PURE__*/_jsxs(\"div\",{ref:callEach(setNodeRef1,setNodeRef2),...listeners,...attributes,style:{display:\"flex\",flexFlow:\"row\",alignItems:\"stretch\",visibility:!isCopySource&&!(activeDrag!==null&&activeDrag!==void 0&&activeDrag.copyOnDrop)&&(active===null||active===void 0?void 0:active.id)===id?\"hidden\":\"unset\"// Replaced with DragOverlay:\n// transform: CSS.Translate.toString(transform)\n},className:\"block-outer-container\",onContextMenu:event=>{onContextMenu===null||onContextMenu===void 0?void 0:onContextMenu(indexPath);},\"data-no-dnd\":preventDrag,onClick:nameable?event=>{event.preventDefault();event.stopPropagation();editor.nameBinding(indexPath);}:undefined,onDoubleClick:async event=>{event.preventDefault();event.stopPropagation();await(onEditValue===null||onEditValue===void 0?void 0:onEditValue(indexPath,doubleClickAppliesAsFunction));rerender===null||rerender===void 0?void 0:rerender();},children:[/*#__PURE__*/_jsx(\"div\",{ref:div=>divRef.current=div,style:{zIndex:indexPath.tree.zIndex},className:`block block-${data.type} ${draggable||forDragOverlay?\"block-draggable\":\"\"} ${nameable?\"block-nameable\":\"\"} ${forDragOverlay?\"block-dragging\":validDraggedOver?\"block-dragged-over\":\"\"} ${forDragOverlay&&(over===null||over===void 0?void 0:over.id)===\"library\"?\"block-drop-will-delete\":\"\"} ${!!runtimeError?\"block-error\":\"\"} ${!!typecheckingError?\"block-warning\":\"\"} ${identifierTag?`block-identifier-${identifierTag}`:\"\"} ${data.type===\"name-hole\"&&data.phantom?\"block-name-hole-phantom\":\"\"}`,onMouseOver:event=>{if(event.target.closest(\".block\")===divRef.current){setTooltipVisible(true);}},onMouseOut:event=>{if(event.target.closest(\".block\")===divRef.current){setTooltipVisible(false);}},children:renderData()}),data.type===\"hlist\"&&expr&&expr.kind===\"List\"?/*#__PURE__*/_jsx(BlockPullTab,{id:`${id}-pull-tab`,indexPath:extendIndexPath(indexPath,1/* tail slot */+expr.heads.length),isCopySource:isCopySource,onEditValue:onEditValue}):data.type===\"happly\"&&expr&&expr.kind===\"call\"?/*#__PURE__*/_jsx(BlockPullTab,{id:`${id}-pull-tab`,indexPath:extendIndexPath(indexPath,1/* called */+expr.args.length),isCopySource:isCopySource,onEditValue:onEditValue}):isAndOr?/*#__PURE__*/_jsx(BlockPullTab,{id:`${id}-pull-tab`,indexPath:extendIndexPath(indexPath,expr.args.length),isCopySource:isCopySource,onEditValue:onEditValue}):isVariadicCall?/*#__PURE__*/_jsx(BlockPullTab,{id:`${id}-pull-tab`,indexPath:extendIndexPath(indexPath,1/* called */+expr.args.length),isCopySource:isCopySource,onEditValue:onEditValue}):\"\"]})})})]});function renderData(){switch(data.type){case\"hat\":{const{id,heading}=data;return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"block-hat-heading\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"block-hat-label\",children:id}),heading]}),children]});}case\"v\":{const{id,heading}=data;return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"block-v-heading\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"block-v-label\",children:id}),heading]}),children]});}case\"h\":{var _binding$attributes3;const{id,binding,definesSymbol,argCount}=data;const renderAsInfix=(binding===null||binding===void 0?void 0:(_binding$attributes3=binding.attributes)===null||_binding$attributes3===void 0?void 0:_binding$attributes3.infix)&&(argCount!==null&&argCount!==void 0?argCount:0)>1;return/*#__PURE__*/_jsxs(_Fragment,{children:[!definesSymbol&&!renderAsInfix&&/*#__PURE__*/_jsx(\"div\",{className:\"block-h-label\",children:id}),children]});}case\"happly\":{return/*#__PURE__*/_jsx(_Fragment,{children:children});}case\"hlist\":{const{tail}=data;return/*#__PURE__*/_jsxs(_Fragment,{children:[children,tail&&/*#__PURE__*/_jsxs(_Fragment,{children:[\".\",tail]})]});}case\"ident\":case\"symbol\":{const{id}=data;return id;}case\"string\":{const{value}=data;return`\"${value.replace(/[\"\\\\]/g,\"\\\\$&\")}\"`;}case\"name-binding\":{const{id}=data;return/*#__PURE__*/_jsxs(_Fragment,{children:[id,children]});}case\"type-name-binding\":case\"type\":case\"type-var\":{const{id}=data;const renderAsInfix=data.type===\"type\"&&id===\"Function\";return/*#__PURE__*/_jsxs(_Fragment,{children:[!renderAsInfix&&/*#__PURE__*/_jsx(\"div\",{className:\"block-type-label\",children:id}),children]});}case\"number\":{const{value}=data;return/*#__PURE__*/_jsx(\"div\",{children:value});}case\"bool\":{const{value}=data;return/*#__PURE__*/_jsx(\"div\",{children:value?\"true\":\"false\"});}case\"hole\":{return/*#__PURE__*/_jsx(\"div\",{className:\"block-hole-symbol\"});}case\"name-hole\":{return/*#__PURE__*/_jsx(\"div\",{className:\"block-name-hole-symbol\"});}case\"type-name-hole\":{return/*#__PURE__*/_jsx(\"div\",{className:\"block-type-name-hole-symbol\"});}}}}","map":{"version":3,"names":["useContext","useEffect","useRef","useState","useDraggable","useDroppable","ContextMenuTrigger","callEach","nodeAtIndexPath","extendIndexPath","BlockPullTab","Tippy","followCursor","functionMaxArgCount","hasTag","prettyPrintType","describeTypecheckError","ActiveDragContext","OnContextMenuContext","RenderCounterContext","RerenderContext","describeRuntimeError","prettyPrintSignatureNames","jsxs","_jsxs","Fragment","_Fragment","jsx","_jsx","Block","_ref","_indexPath$path","_binding$cell$value","_binding$attributes","id","indexPath","data","isCopySource","typechecker","editor","identifierTag","forDragOverlay","onEditValue","children","activeDrag","onContextMenu","rerender","isAnyType","type","nameable","tree","startsWith","preventDrag","droppable","path","length","usedDroppable","isOver","setNodeRef","setNodeRef1","binding","draggable","usedDraggable","copyOnDrop","contextHelpSubject","active","over","attributes","listeners","setNodeRef2","expr","undefined","divRef","tooltipVisible","setTooltipVisible","setType","calledType","setCalledType","inferSubexprType","kind","error","_describeTypecheckErr","document","body","classList","add","remove","contextHelp","cell","value","doc","_binding$cell$value2","contextHelpName","className","name","signature","contextHelpDoc","_binding$attributes2","match","rendered","exec","slice","typecheckingError","errors","for","runtimeError","runner","program","evaluator","doubleClickAppliesAsFunction","tooltipContentParts","filter","x","tooltipContent","style","gap","map","part","index","contextMenuID","_data$binding","_data$binding$attribu","evaluable","typeAnnotation","calledIsVar","returnTypeAnnotation","isTypeBlock","validDraggedOver","node","isVariadicCall","args","isAndOr","content","visible","arrow","plugins","offset","placement","zIndex","ref","display","flexFlow","alignItems","visibility","event","onClick","preventDefault","stopPropagation","nameBinding","onDoubleClick","div","current","phantom","onMouseOver","target","closest","onMouseOut","renderData","heads","heading","_binding$attributes3","definesSymbol","argCount","renderAsInfix","infix","tail","replace"],"sources":["/Users/hamzashahzad/Desktop/resume_projects/sparkground/src/editor/blocks/Block.tsx"],"sourcesContent":["import { PropsWithChildren, ReactNode, useContext, useEffect, useRef, useState } from \"react\";\nimport { Over, UniqueIdentifier, useDraggable, useDroppable } from \"@dnd-kit/core\";\nimport { ContextMenuTrigger } from \"rctx-contextmenu\";\nimport { callEach } from \"../../util\";\nimport { TreeIndexPath, nodeAtIndexPath, extendIndexPath } from \"../trees/tree\";\nimport BlockPullTab from \"./BlockPullTab\";\nimport Tippy from \"@tippyjs/react\";\nimport { followCursor } from \"tippy.js\";\nimport { Type, functionMaxArgCount, hasTag } from \"../../typechecker/type\";\nimport { prettyPrintType } from \"../../typechecker/serialize\";\nimport { describeTypecheckError } from \"../../typechecker/errors\";\nimport {\n  ActiveDragContext,\n  OnContextMenuContext,\n  RenderCounterContext,\n  RerenderContext,\n} from \"../editor-contexts\";\nimport { Binding } from \"../library/environments\";\nimport { FnValue, Value } from \"../../evaluator/value\";\nimport { Typechecker } from \"../../typechecker/typecheck\";\nimport { describeRuntimeError } from \"../../evaluator/errors\";\nimport { prettyPrintSignatureNames } from \"../../evaluator/dynamic-type\";\nimport { Program } from \"../../simulator/program\";\nimport { Editor } from \"../state/Editor\";\n\ntype Props = PropsWithChildren<{\n  id: UniqueIdentifier;\n  indexPath: TreeIndexPath;\n\n  data: BlockData;\n  isCopySource?: boolean;\n\n  typechecker: Typechecker;\n  editor: Editor;\n  identifierTag?: string;\n\n  forDragOverlay?: boolean | Over;\n\n  onEditValue?: (indexPath: TreeIndexPath, applyAsFunction?: boolean) => Promise<void>;\n}>;\n\nexport type BlockData =\n  | Hat\n  | Vertical\n  | Horizontal\n  | HorizontalApply\n  | HorizontalList\n  | Identifier\n  | NameBinding\n  | NameHole\n  | TypeData\n  | TypeVarData\n  | TypeNameBinding\n  | TypeNameHole\n  | Symbol\n  | String\n  | Number\n  | Bool\n  | Hole;\n\ntype Hat = {\n  type: \"hat\";\n  id: string;\n  binding?: Binding<unknown>;\n  calledIsVar?: boolean;\n  heading?: JSX.Element;\n};\ntype Vertical = {\n  type: \"v\";\n  id: string;\n  binding?: Binding<unknown>;\n  calledIsVar?: boolean;\n  heading?: JSX.Element;\n  returnTypeAnnotation?: Type;\n};\ntype Horizontal = {\n  type: \"h\";\n  id: string;\n  binding?: Binding<unknown>;\n  calledIsVar?: boolean;\n  definesSymbol?: boolean;\n  argCount?: number;\n  returnTypeAnnotation?: Type;\n};\ntype HorizontalApply = {\n  type: \"happly\";\n};\ntype HorizontalList = {\n  type: \"hlist\";\n  tail?: ReactNode;\n};\ntype Identifier = {\n  type: \"ident\";\n  id: string;\n  binding?: Binding<unknown>;\n};\ntype NameBinding = {\n  type: \"name-binding\";\n  id: string;\n  binding?: Binding<unknown>;\n};\ntype TypeNameBinding = {\n  type: \"type-name-binding\";\n  id: string;\n};\ntype NameHole = {\n  type: \"name-hole\";\n  phantom?: boolean;\n};\ntype TypeData = {\n  type: \"type\";\n  id: string;\n};\ntype TypeVarData = {\n  type: \"type-var\";\n  id: string;\n};\ntype TypeNameHole = {\n  type: \"type-name-hole\";\n};\ntype Symbol = {\n  type: \"symbol\";\n  id: string;\n};\ntype String = {\n  type: \"string\";\n  value: string;\n};\ntype Number = {\n  type: \"number\";\n  value: number;\n};\ntype Bool = {\n  type: \"bool\";\n  value: boolean;\n};\ntype Hole = {\n  type: \"hole\";\n};\n\nexport default function Block({\n  id,\n  indexPath,\n\n  data,\n  isCopySource,\n\n  typechecker,\n  editor,\n  identifierTag,\n\n  forDragOverlay,\n\n  onEditValue,\n\n  children,\n}: Props) {\n  const activeDrag = useContext(ActiveDragContext);\n\n  const onContextMenu = useContext(OnContextMenuContext);\n\n  const rerender = useContext(RerenderContext);\n  useContext(RenderCounterContext);\n\n  const isAnyType = data.type === \"type\" && data.id === \"?\";\n  const nameable =\n    (data.type === \"name-hole\" || data.type === \"type-name-hole\") &&\n    !indexPath.tree.id.startsWith(\"library\");\n  const preventDrag = nameable || isAnyType;\n\n  // Drop area, if applicable\n  const droppable = !(isCopySource || indexPath.path?.length === 0);\n  // Need to call useDroppable hook on *every* render\n  const usedDroppable = useDroppable({\n    id,\n    data: { indexPath },\n  });\n  let { isOver, setNodeRef: setNodeRef1 } = droppable\n    ? usedDroppable\n    : {\n        isOver: false,\n        setNodeRef: () => {},\n      };\n\n  let binding: Binding<unknown> | undefined;\n  switch (data.type) {\n    case \"hat\":\n    case \"v\":\n    case \"h\":\n    case \"ident\":\n    case \"name-binding\":\n      binding = data.binding;\n  }\n\n  // Draggable, if applicable\n  const draggable = !(\n    forDragOverlay ||\n    data.type === \"hole\" ||\n    data.type === \"name-hole\" ||\n    data.type === \"type-name-hole\" ||\n    isAnyType\n  );\n  // Also need to call useDraggable hook on *every* render\n  const usedDraggable = useDraggable({\n    id,\n    data: {\n      indexPath,\n      copyOnDrop: isCopySource,\n      contextHelpSubject: binding,\n    },\n  });\n  let {\n    active,\n    over,\n    attributes,\n    listeners,\n    setNodeRef: setNodeRef2,\n  } = draggable\n    ? usedDraggable\n    : {\n        active: null,\n        over: typeof forDragOverlay === \"object\" ? forDragOverlay : null,\n        attributes: [],\n        listeners: [],\n        setNodeRef: () => {},\n      };\n\n  const expr = (() => {\n    try {\n      return nodeAtIndexPath(indexPath);\n    } catch {\n      return undefined;\n    }\n  })();\n\n  const divRef = useRef<HTMLElement | null>(null);\n\n  const [tooltipVisible, setTooltipVisible] = useState(false);\n  const [type, setType] = useState<Type | string>(\"\");\n  const [calledType, setCalledType] = useState<Type>();\n\n  useEffect(() => {\n    try {\n      setType(typechecker.inferSubexprType(indexPath));\n      setCalledType(\n        expr?.kind === \"call\"\n          ? typechecker.inferSubexprType(extendIndexPath(indexPath, 0))\n          : undefined,\n      );\n    } catch (error) {\n      setType(describeTypecheckError(error) ?? `${error}`);\n    }\n\n    if (identifierTag) {\n      if (tooltipVisible) {\n        document.body.classList.add(`highlight-identifier-${identifierTag}`);\n      } else {\n        document.body.classList.remove(`highlight-identifier-${identifierTag}`);\n      }\n    }\n\n    rerender?.();\n  }, [tooltipVisible, activeDrag]);\n\n  let contextHelp: JSX.Element | undefined;\n\n  // TODO: Stop relying on Value bindings here; use a richer `doc` attribute instead\n  if (binding && ((binding.cell.value as Value)?.kind === \"fn\" || binding.attributes?.doc)) {\n    const contextHelpName = (\n      <div className=\"fst-mono d-flex align-items-end\">\n        {\n          // TODO: Stop relying on Value bindings here; use a richer `doc` attribute instead\n          (binding.cell.value as Value)?.kind === \"fn\" ? (\n            <>\n              ({binding.name}\n              <div className=\"ms-2 fst-italic\">\n                {prettyPrintSignatureNames((binding.cell.value as FnValue).signature)}{\" \"}\n              </div>\n              )\n            </>\n          ) : (\n            binding.name\n          )\n        }\n      </div>\n    );\n\n    const contextHelpDoc = (\n      <div className=\"mt-1\">\n        {(() => {\n          let doc = binding.attributes?.doc;\n          if (!doc) return \"\";\n\n          let match: RegExpExecArray | null;\n          let rendered = <></>;\n          while ((match = /^(?:[^`]+|`([^`]+)`)/.exec(doc))) {\n            doc = doc.slice(match[0].length);\n            if (match[1]) {\n              rendered = (\n                <>\n                  {rendered}\n                  <span className=\"fst-mono fst-italic\">{match[1]}</span>\n                </>\n              );\n            } else {\n              rendered = (\n                <>\n                  {rendered}\n                  {match[0]}\n                </>\n              );\n            }\n          }\n\n          return rendered;\n        })()}\n      </div>\n    );\n\n    contextHelp = (\n      <>\n        {contextHelpName} {contextHelpDoc}\n      </>\n    );\n  }\n\n  let typecheckingError = typechecker.errors.for(indexPath);\n  if (!typecheckingError && expr?.kind === \"call\") {\n    typecheckingError = typechecker.errors.for(extendIndexPath(indexPath, 0));\n  }\n\n  const runtimeError = editor.runner.program.evaluator.errors.for(indexPath);\n\n  const doubleClickAppliesAsFunction =\n    data.type === \"ident\" &&\n    typeof type === \"object\" &&\n    (hasTag(type, \"Function\") || hasTag(type, \"Function*\"));\n\n  const tooltipContentParts = [\n    data.type === \"name-binding\" && <small>Double-click to rename this variable</small>,\n    nameable && (\n      <small>Click to name this {data.type === \"type-name-hole\" ? \"type \" : \"\"}variable</small>\n    ),\n    isAnyType && <small>Unknown type; you can drop a more specific type here</small>,\n    onEditValue && data.type === \"bool\" && <small>Double-click to toggle value</small>,\n    onEditValue && (data.type === \"number\" || data.type === \"string\") && (\n      <small>Double-click to edit value</small>\n    ),\n    onEditValue && doubleClickAppliesAsFunction && <small>Double-click to apply function</small>,\n\n    // Uncomment to see each block's index path in its tooltip:\n    // <>\n    //   <b>Index Path:</b> {indexPath.path.map((x) => `${x}`).join(\" \")}\n    // </>,\n\n    // Uncomment to see unbound references in each block's subtree, when considered\n    // in isolation from its true context:\n    // <>\n    //   <b>Subtree Unbound References:</b>{\" \"}\n    //   {unboundReferences(indexPath)\n    //     .map((varRef) => varRef.id)\n    //     .join(\", \")}\n    // </>,\n\n    !!runtimeError && (\n      <span className=\"text-warning\">\n        <b>Runtime Error:</b> <i>{describeRuntimeError(runtimeError)}</i>\n      </span>\n    ),\n\n    !!typecheckingError && (\n      <span className=\"text-warning\">\n        <b>Type Error:</b> <i>{describeTypecheckError(typecheckingError)}</i>{\" \"}\n      </span>\n    ),\n    data.type !== \"type\" &&\n      data.type !== \"type-var\" &&\n      data.type !== \"type-name-binding\" &&\n      data.type !== \"type-name-hole\" && (\n        <>\n          <b>Type:</b>\n          <div className=\"mt-1 ms-2\">\n            {typeof type === \"string\" ? (\n              <span className=\"text-warning\">\n                Error: <i>{type}</i>{\" \"}\n              </span>\n            ) : (\n              <span className=\"fst-mono\">{prettyPrintType(type)}</span>\n            )}\n          </div>\n        </>\n      ),\n    calledType && (\n      <>\n        <b>Function Type:</b>\n        <div className=\"mt-1 ms-2\">\n          <span className=\"fst-mono\">{prettyPrintType(calledType)}</span>\n        </div>\n      </>\n    ),\n\n    contextHelp && (\n      <>\n        <b>Help:</b>\n        <div className=\"mt-1 ms-2\">{contextHelp}</div>\n      </>\n    ),\n  ].filter((x) => x);\n\n  const tooltipContent = tooltipContentParts.length ? (\n    <div className=\"d-flex flex-column mb-1\" style={{ gap: \"0.5em\" }}>\n      {tooltipContentParts.map((part, index) => (\n        <div key={index}>{part}</div>\n      ))}\n    </div>\n  ) : (\n    \"\"\n  );\n\n  const contextMenuID = (() => {\n    // TODO: Fix this unbound reference detection\n    //       (it doesn't have access to the correct environment at the moment)\n    // const evaluable = expr && unboundReferences(indexPath).length === 0 ? \"-evaluable\" : \"\";\n    const evaluable = \"-evaluable\";\n\n    switch (data.type) {\n      case \"ident\":\n        return \"block-menu-var\" + evaluable;\n      case \"name-binding\":\n        return data.binding?.attributes?.typeAnnotation\n          ? \"block-menu-namebinding-annotated\"\n          : \"block-menu-namebinding\";\n      case \"name-hole\":\n        return \"block-menu-namehole\";\n      case \"type-name-binding\":\n        return \"block-menu-typenamebinding\";\n      case \"type-name-hole\":\n        return \"block-menu-typenamehole\";\n      case \"h\":\n      case \"v\":\n        return (\n          (data.calledIsVar\n            ? \"block-menu-call\"\n            : data.id === \"function\"\n              ? data.returnTypeAnnotation\n                ? \"block-menu-function-annotated\"\n                : \"block-menu-function\"\n              : \"block-menu\") + evaluable\n        );\n      case \"happly\":\n        return (data ? \"block-menu-apply\" : \"block-menu\") + evaluable;\n    }\n\n    return \"block-menu\" + evaluable;\n  })();\n\n  const isTypeBlock = (data: BlockData) => data.type === \"type\" || data.type === \"type-var\";\n  const validDraggedOver = isOver && (!isTypeBlock(data) || activeDrag?.node.kind === \"type\");\n\n  const isVariadicCall =\n    data.type === \"h\" &&\n    expr &&\n    expr.kind === \"call\" &&\n    (typeof type !== \"string\" && calledType\n      ? expr.args.length < functionMaxArgCount(calledType)\n      : true);\n  const isAndOr = expr?.kind === \"and\" || expr?.kind === \"or\";\n\n  return (\n    <>\n      <style>\n        {identifierTag\n          ? `\n          body.highlight-identifier-${identifierTag} .block-identifier-${identifierTag} > .block-hat-heading > .block-hat-label,\n          body.highlight-identifier-${identifierTag} .block-identifier-${identifierTag} > .block-v-heading > .block-v-label,\n          body.highlight-identifier-${identifierTag} .block-identifier-${identifierTag} > .block-h-label,\n          body.highlight-identifier-${identifierTag} .block-identifier-${identifierTag}.block-ident,\n          body.highlight-identifier-${identifierTag} .block-identifier-${identifierTag}.block-name-binding {\n            transition: all 50ms linear;\n            \n            font-weight: bold;\n            \n            box-shadow: 0px 0px 0.25em 0.4em rgba(255, 255, 50);\n            background-color: rgba(255, 255, 50)\n          }\n        `\n          : \"\"}\n      </style>\n\n      <ContextMenuTrigger id={contextMenuID}>\n        <Tippy\n          content={tooltipContent}\n          className={\"text-bg-primary\"}\n          visible={!!tooltipContent && tooltipVisible && !forDragOverlay}\n          arrow={false}\n          plugins={[followCursor]}\n          followCursor={true}\n          offset={[5, 10]}\n          placement=\"top-start\"\n          zIndex={99999999 + 2}\n        >\n          <div\n            ref={callEach(setNodeRef1, setNodeRef2)}\n            {...listeners}\n            {...attributes}\n            style={{\n              display: \"flex\",\n              flexFlow: \"row\",\n              alignItems: \"stretch\",\n\n              visibility:\n                !isCopySource && !activeDrag?.copyOnDrop && active?.id === id ? \"hidden\" : \"unset\",\n              // Replaced with DragOverlay:\n              // transform: CSS.Translate.toString(transform)\n            }}\n            className=\"block-outer-container\"\n            onContextMenu={(event) => {\n              onContextMenu?.(indexPath);\n            }}\n            data-no-dnd={preventDrag}\n            onClick={\n              nameable\n                ? (event) => {\n                    event.preventDefault();\n                    event.stopPropagation();\n\n                    editor.nameBinding(indexPath);\n                  }\n                : undefined\n            }\n            onDoubleClick={async (event) => {\n              event.preventDefault();\n              event.stopPropagation();\n\n              await onEditValue?.(indexPath, doubleClickAppliesAsFunction);\n              rerender?.();\n            }}\n          >\n            <div\n              ref={(div) => (divRef.current = div)}\n              style={{\n                zIndex: indexPath.tree.zIndex,\n              }}\n              className={`block block-${data.type} ${\n                draggable || forDragOverlay ? \"block-draggable\" : \"\"\n              } ${nameable ? \"block-nameable\" : \"\"} ${\n                forDragOverlay ? \"block-dragging\" : validDraggedOver ? \"block-dragged-over\" : \"\"\n              } ${forDragOverlay && over?.id === \"library\" ? \"block-drop-will-delete\" : \"\"} ${\n                !!runtimeError ? \"block-error\" : \"\"\n              } ${!!typecheckingError ? \"block-warning\" : \"\"} ${\n                identifierTag ? `block-identifier-${identifierTag}` : \"\"\n              } ${data.type === \"name-hole\" && data.phantom ? \"block-name-hole-phantom\" : \"\"}`}\n              onMouseOver={(event) => {\n                if ((event.target as Element).closest(\".block\") === divRef.current) {\n                  setTooltipVisible(true);\n                }\n              }}\n              onMouseOut={(event) => {\n                if ((event.target as Element).closest(\".block\") === divRef.current) {\n                  setTooltipVisible(false);\n                }\n              }}\n            >\n              {renderData()}\n            </div>\n\n            {data.type === \"hlist\" && expr && expr.kind === \"List\" ? (\n              <BlockPullTab\n                id={`${id}-pull-tab`}\n                indexPath={extendIndexPath(indexPath, 1 /* tail slot */ + expr.heads.length)}\n                isCopySource={isCopySource}\n                onEditValue={onEditValue}\n              />\n            ) : data.type === \"happly\" && expr && expr.kind === \"call\" ? (\n              <BlockPullTab\n                id={`${id}-pull-tab`}\n                indexPath={extendIndexPath(indexPath, 1 /* called */ + expr.args.length)}\n                isCopySource={isCopySource}\n                onEditValue={onEditValue}\n              />\n            ) : isAndOr ? (\n              <BlockPullTab\n                id={`${id}-pull-tab`}\n                indexPath={extendIndexPath(indexPath, expr.args.length)}\n                isCopySource={isCopySource}\n                onEditValue={onEditValue}\n              />\n            ) : isVariadicCall ? (\n              <BlockPullTab\n                id={`${id}-pull-tab`}\n                indexPath={extendIndexPath(indexPath, 1 /* called */ + expr.args.length)}\n                isCopySource={isCopySource}\n                onEditValue={onEditValue}\n              />\n            ) : (\n              \"\"\n            )}\n          </div>\n        </Tippy>\n      </ContextMenuTrigger>\n    </>\n  );\n\n  function renderData() {\n    switch (data.type) {\n      case \"hat\": {\n        const { id, heading } = data;\n\n        return (\n          <>\n            <div className=\"block-hat-heading\">\n              <div className=\"block-hat-label\">{id}</div>\n              {heading}\n            </div>\n\n            {children}\n          </>\n        );\n      }\n\n      case \"v\": {\n        const { id, heading } = data;\n\n        return (\n          <>\n            <div className=\"block-v-heading\">\n              <div className=\"block-v-label\">{id}</div>\n              {heading}\n            </div>\n\n            {children}\n          </>\n        );\n      }\n\n      case \"h\": {\n        const { id, binding, definesSymbol, argCount } = data;\n\n        const renderAsInfix = binding?.attributes?.infix && (argCount ?? 0) > 1;\n\n        return (\n          <>\n            {!definesSymbol && !renderAsInfix && <div className=\"block-h-label\">{id}</div>}\n\n            {children}\n          </>\n        );\n      }\n\n      case \"happly\": {\n        return <>{children}</>;\n      }\n\n      case \"hlist\": {\n        const { tail } = data;\n\n        return (\n          <>\n            {children}\n\n            {tail && <>.{tail}</>}\n          </>\n        );\n      }\n\n      case \"ident\":\n      case \"symbol\": {\n        const { id } = data;\n\n        return id;\n      }\n\n      case \"string\": {\n        const { value } = data;\n\n        return `\"${value.replace(/[\"\\\\]/g, \"\\\\$&\")}\"`;\n      }\n\n      case \"name-binding\": {\n        const { id } = data;\n\n        return (\n          <>\n            {id}\n\n            {children}\n          </>\n        );\n      }\n\n      case \"type-name-binding\":\n      case \"type\":\n      case \"type-var\": {\n        const { id } = data;\n\n        const renderAsInfix = data.type === \"type\" && id === \"Function\";\n\n        return (\n          <>\n            {!renderAsInfix && <div className=\"block-type-label\">{id}</div>}\n\n            {children}\n          </>\n        );\n      }\n\n      case \"number\": {\n        const { value } = data;\n\n        return <div>{value}</div>;\n      }\n\n      case \"bool\": {\n        const { value } = data;\n\n        return <div>{value ? \"true\" : \"false\"}</div>;\n      }\n\n      case \"hole\": {\n        return <div className=\"block-hole-symbol\" />;\n      }\n\n      case \"name-hole\": {\n        return <div className=\"block-name-hole-symbol\" />;\n      }\n\n      case \"type-name-hole\": {\n        return <div className=\"block-type-name-hole-symbol\" />;\n      }\n    }\n  }\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}